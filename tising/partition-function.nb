(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     68113,       1772]
NotebookOptionsPosition[     65527,       1726]
NotebookOutlinePosition[     65955,       1743]
CellTagsIndexPosition[     65912,       1740]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Minimal Model Characters Definitions\n",
  FontWeight->"Bold"],
 "Notice that we assume that x is purely real in these calculations. This \
corresponds to considering the rectangular torus."
}], "Text",
 CellChangeTimes->{{3.952433305709972*^9, 3.9524333142214117`*^9}, {
  3.952437456020094*^9, 
  3.952437478668242*^9}},ExpressionUUID->"b3cb9778-9a98-4369-b810-\
b63afe3fb0e2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";", 
  RowBox[{"LaunchKernels", "[", "8", "]"}], ";", "$KernelCount"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "'"}], "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"1", "-", 
    RowBox[{"6", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "-", 
         RowBox[{"p", "'"}]}], ")"}], "2"], 
      RowBox[{"p", " ", 
       RowBox[{"p", "'"}]}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h", "[", 
    RowBox[{"r_", ",", "s_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", " ", "r"}], " ", "-", " ", 
        RowBox[{
         RowBox[{"p", "'"}], " ", "s"}]}], ")"}], "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"p", " ", "-", " ", 
        RowBox[{"p", "'"}]}], ")"}], "2"]}], 
    RowBox[{"4", " ", "p", " ", 
     RowBox[{"p", "'"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]inv", "[", 
    RowBox[{"q_", ",", 
     RowBox[{"N_", ":", "\[Infinity]"}]}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox["q", 
     RowBox[{"-", 
      FractionBox["1", "24"]}]], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"k", "=", "0"}], "N"], 
     RowBox[{
      RowBox[{"PartitionsP", "[", "k", "]"}], 
      SuperscriptBox["q", "k"]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K", "[", 
    RowBox[{"r_", ",", "s_", ",", "q_", ",", 
     RowBox[{"N_", ":", "\[Infinity]"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Eta]inv", "[", 
     RowBox[{"q", ",", "N"}], "]"}], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"n", "=", 
       RowBox[{"-", "N"}]}], "N"], 
     SuperscriptBox["q", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "p", " ", 
           RowBox[{"p", "'"}], " ", "n"}], " ", "+", " ", 
          RowBox[{"p", " ", "r"}], " ", "-", " ", 
          RowBox[{
           RowBox[{"p", "'"}], " ", "s"}]}], ")"}], "2"], 
       RowBox[{"4", " ", "p", " ", 
        RowBox[{"p", "'"}]}]]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]o", "[", 
    RowBox[{"r_", ",", "s_", ",", "q_", ",", 
     RowBox[{"N_", ":", "\[Infinity]"}]}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"QPochhammer", "[", 
      RowBox[{"q", ",", "q"}], "]"}]], 
    RowBox[{"Total", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox["q", 
         RowBox[{
          RowBox[{
           SuperscriptBox["n", "2"], "p", " ", 
           RowBox[{"p", "'"}]}], "+", 
          RowBox[{"n", " ", "p", " ", "r"}], "-", 
          RowBox[{
           RowBox[{"p", "'"}], "n", " ", "s"}]}]], "-", 
        SuperscriptBox["q", 
         RowBox[{
          RowBox[{
           SuperscriptBox["n", "2"], "p", " ", 
           RowBox[{"p", "'"}]}], "+", 
          RowBox[{"n", " ", "p", " ", "r"}], "+", 
          RowBox[{
           RowBox[{"p", "'"}], "n", " ", "s"}], "+", 
          RowBox[{"r", " ", "s"}]}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", 
         RowBox[{"-", "N"}], ",", "N"}], "}"}]}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]", "[", 
    RowBox[{"r_", ",", "s_", ",", "q_", ",", 
     RowBox[{"N_", ":", "\[Infinity]"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"K", "[", 
     RowBox[{"r", ",", "s", ",", "q", ",", "N"}], "]"}], "-", 
    RowBox[{"K", "[", 
     RowBox[{"r", ",", 
      RowBox[{"-", "s"}], ",", "q", ",", "N"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]f", "[", 
    RowBox[{"i_", ",", "j_", ",", "q_", ",", "N_"}], "]"}], ":=", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"\[Chi]", "[", 
      RowBox[{
       RowBox[{"i", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"i", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "q", ",", "N"}], "]"}], 
     RowBox[{"\[Chi]", "[", 
      RowBox[{
       RowBox[{"j", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"j", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "q", ",", "N"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"list", "[", 
    RowBox[{"M_", ",", "W_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"MS", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"W", "[", 
           RowBox[{"[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"W", "[", 
           RowBox[{"[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"MS", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "}"}], "&"}], 
       "/@", 
       RowBox[{"Position", "[", 
        RowBox[{"MS", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", " ", "!=", " ", "0"}], "&"}], ")"}]}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}], "[", 
    RowBox[{"FullSimplify", "[", "M", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Z", "[", 
     RowBox[{"q_", ",", "M_", ",", 
      RowBox[{"N_", ":", "\[Infinity]"}], ",", 
      RowBox[{"\[Chi]Z_", ":", "\[Chi]"}]}], "]"}], ":=", 
    RowBox[{"Total", "[", 
     RowBox[{"ParallelMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], 
         RowBox[{"\[Chi]Z", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "q", ",", "N"}], 
          "]"}], " ", 
         RowBox[{
          RowBox[{"\[Chi]Z", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "q", ",", "N"}], 
           "]"}], "\[Conjugate]"}]}], "&"}], ",", "M"}], "]"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "is", " ", "an", " ", "optimized", " ", "Way", " ", "to", " ",
     "calculate", " ", "an", " ", "arbitrary", " ", "partition", " ", 
    "function"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Zop", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Truncate", "->", "5"}], ",", 
     RowBox[{"UpToOrder", "->", "2"}], ",", 
     RowBox[{"Divisor", "->", 
      RowBox[{"-", "1"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Zop", "[", 
    RowBox[{"terms_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cardinality", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "Divisor", "]"}], ">", "0"}], ",", 
        RowBox[{"OptionValue", "[", "Divisor", "]"}], ",", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Length", "[", "terms", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partitionFunctions", "=", 
      RowBox[{"Total", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Z", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"OptionValue", "[", "Truncate", "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
         RowBox[{"ParallelMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"list", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], ",", "terms"}],
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"term", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParallelMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Refine", "[", 
            RowBox[{"#", ",", 
             RowBox[{"q", ">", "0"}]}], "]"}], "&"}], ",", 
          FractionBox[
           RowBox[{"List", " ", "@@", "partitionFunctions"}], 
           "cardinality"]}], "]"}], "//.", 
        RowBox[{
         RowBox[{"Conjugate", "[", "sum_Plus", "]"}], ":>", 
         RowBox[{"Map", "[", 
          RowBox[{"Conjugate", ",", "sum"}], "]"}]}]}], "//", 
       RowBox[{
        RowBox[{"Refine", "[", 
         RowBox[{"#", ",", 
          RowBox[{"q", ">", "0"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Zz", "=", 
      RowBox[{"Total", "[", 
       RowBox[{"ParallelMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Series", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"q", ",", "0", ",", 
              RowBox[{"OptionValue", "[", "UpToOrder", "]"}]}], "}"}], ",", 
            RowBox[{"Assumptions", "->", 
             RowBox[{"q", ">", "0"}]}]}], "]"}], "&"}], ",", "term"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Total", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{
           RowBox[{"Re", "[", "#", "]"}], ",", 
           RowBox[{"Assumptions", "->", 
            RowBox[{"q", ">", "0"}]}]}], "]"}], "&"}], ",", 
        RowBox[{"List", "@@", 
         RowBox[{"Normal", "[", "Zz", "]"}]}]}], "]"}], "]"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.952429983182838*^9, 3.952430021476263*^9}, {
   3.9524300897810183`*^9, 3.9524301073336267`*^9}, {3.9524301704863377`*^9, 
   3.952430255519491*^9}, {3.952430486514429*^9, 3.952430563259561*^9}, {
   3.952430595948324*^9, 3.952430875359701*^9}, 3.952430928527976*^9, 
   3.9524310128353148`*^9, {3.952431134030175*^9, 3.9524311348992767`*^9}, {
   3.952431229227233*^9, 3.9524312407942057`*^9}, {3.952431284562497*^9, 
   3.952431379111961*^9}, {3.9524319965130253`*^9, 3.952432101768345*^9}, {
   3.952432365812982*^9, 3.952432367737756*^9}, {3.952432823056398*^9, 
   3.952432903344095*^9}, {3.95243298525526*^9, 3.9524329970767183`*^9}, {
   3.952433049656349*^9, 3.9524330579441957`*^9}, {3.952433156672309*^9, 
   3.95243320383*^9}, 3.952433322687224*^9, {3.9524333557531643`*^9, 
   3.9524333731262493`*^9}, {3.9524334228858023`*^9, 3.952433504733325*^9}, 
   3.952433631253001*^9, {3.952433674452836*^9, 3.9524336994768*^9}, {
   3.952433762309041*^9, 3.9524339132784767`*^9}, {3.9524341176804743`*^9, 
   3.9524341537350903`*^9}, 3.9524342041886806`*^9, {3.952434400376223*^9, 
   3.952434416031733*^9}, {3.952434454391403*^9, 3.9524345038730783`*^9}, {
   3.9524345937701073`*^9, 3.952434616665653*^9}, {3.95243468479385*^9, 
   3.952434737946178*^9}, {3.9524348546746683`*^9, 3.9524348629842663`*^9}, {
   3.952435215420711*^9, 3.952435228004119*^9}, {3.952435486579674*^9, 
   3.952435504686997*^9}, {3.9524359748538313`*^9, 3.9524359781327953`*^9}, {
   3.952436300479841*^9, 3.9524363071104116`*^9}, {3.952437410249794*^9, 
   3.952437420521336*^9}, {3.9524466524357758`*^9, 3.952446656563878*^9}, {
   3.952454061066794*^9, 3.9524540619861183`*^9}, {3.952454312320775*^9, 
   3.952454314015925*^9}, {3.952455175731552*^9, 3.952455176890143*^9}, {
   3.9524557801195307`*^9, 3.952455781142008*^9}, {3.952455827007469*^9, 
   3.952455827838285*^9}, {3.9524560090136003`*^9, 3.9524560379186497`*^9}, {
   3.952456078936064*^9, 3.952456079774953*^9}, {3.952456111144265*^9, 
   3.9524561120066957`*^9}, {3.952608111500798*^9, 3.9526081248682613`*^9}, {
   3.9526854924691067`*^9, 3.952685494034449*^9}, {3.9526938186933527`*^9, 
   3.9526938689716463`*^9}, {3.952693950609221*^9, 3.952693955925447*^9}, {
   3.95269416625032*^9, 3.9526942204007063`*^9}, {3.9526942750425167`*^9, 
   3.952694305158925*^9}, {3.952694340615931*^9, 3.952694392634759*^9}, 
   3.952694856513176*^9, {3.952695010750646*^9, 3.952695054697351*^9}, {
   3.952695211403302*^9, 3.952695345012632*^9}, {3.9526953889475937`*^9, 
   3.952695461320304*^9}, {3.9526954920694733`*^9, 3.9526955132948914`*^9}, {
   3.9526955436285133`*^9, 3.9526955737676497`*^9}, {3.952696051795887*^9, 
   3.952696058146242*^9}, {3.952696163053293*^9, 3.952696169313353*^9}, {
   3.952696872510751*^9, 3.95269693397552*^9}, {3.952697138010035*^9, 
   3.95269733195872*^9}, {3.952697414300913*^9, 3.952697428318832*^9}, {
   3.952697514490156*^9, 3.952697519267601*^9}, {3.9526976103227987`*^9, 
   3.952697616529458*^9}, {3.952697656444903*^9, 3.9526976614659367`*^9}, {
   3.9526977453627453`*^9, 3.952697778305622*^9}, {3.952703943331991*^9, 
   3.952703944291054*^9}, {3.952706213547756*^9, 3.952706222057184*^9}, {
   3.952708411127736*^9, 3.952708417187333*^9}, {3.952709043369442*^9, 
   3.952709049400717*^9}, {3.9527092800157003`*^9, 3.9527092801235743`*^9}, {
   3.952710734346612*^9, 3.952710736100593*^9}, {3.952726697087331*^9, 
   3.952726705830348*^9}, {3.9527268491603117`*^9, 3.952726855078938*^9}, {
   3.952726925265757*^9, 3.952726947176941*^9}, {3.952727065730476*^9, 
   3.952727067084949*^9}, {3.9527271651256933`*^9, 3.9527271819977293`*^9}, {
   3.952727296174863*^9, 3.952727320528326*^9}, {3.95304547272823*^9, 
   3.953045475336047*^9}, {3.9530458869290323`*^9, 3.953045893343459*^9}, {
   3.9530459654986677`*^9, 3.953045967165729*^9}, {3.953046093423422*^9, 
   3.9530460949575253`*^9}, {3.9530489803533897`*^9, 3.953049006069057*^9}, {
   3.9530490644593277`*^9, 3.9530490822854156`*^9}, 3.953049177315525*^9, {
   3.953049268635248*^9, 3.9530493108414583`*^9}, {3.953049386612569*^9, 
   3.953049417286935*^9}, {3.953050860716185*^9, 3.953050942452936*^9}, {
   3.953051089634118*^9, 3.953051141757986*^9}, {3.9530517196622343`*^9, 
   3.9530517210288553`*^9}, {3.953051776627678*^9, 3.953051777464224*^9}, 
   3.9530610017681217`*^9, {3.9530611355709677`*^9, 3.953061140709096*^9}, {
   3.953061402431971*^9, 3.953061406692771*^9}, {3.953061479734418*^9, 
   3.9530615127288*^9}, {3.95306171356151*^9, 3.9530617163208942`*^9}, {
   3.953061841630377*^9, 3.953061882237033*^9}, {3.953062058012095*^9, 
   3.953062072538145*^9}, {3.9530621204823837`*^9, 3.953062120739039*^9}, {
   3.953062429987545*^9, 3.9530624398789167`*^9}, {3.9530628356889057`*^9, 
   3.953062837735694*^9}, {3.953063063746173*^9, 3.953063072110127*^9}, {
   3.953063128267173*^9, 3.9530631296733103`*^9}, {3.953296139954281*^9, 
   3.9532962172745457`*^9}, {3.953297131276202*^9, 3.9532971758198223`*^9}, {
   3.953646551249085*^9, 3.9536465534556417`*^9}, {3.953650366700644*^9, 
   3.953650413045669*^9}, {3.9536506199983664`*^9, 3.953650733046385*^9}, {
   3.953650783584256*^9, 3.953650794847662*^9}, {3.953652627626725*^9, 
   3.953652636610532*^9}, {3.954500603102611*^9, 3.954500610445191*^9}, {
   3.9545006408535748`*^9, 3.954500731026745*^9}, {3.9545836907618856`*^9, 
   3.9545837431758347`*^9}, {3.954584404138474*^9, 3.954584406594721*^9}, {
   3.954584467722526*^9, 3.954584509511805*^9}, {3.954584546370388*^9, 
   3.954584569826084*^9}, {3.9545846009146967`*^9, 3.954584615237125*^9}, {
   3.954584659322291*^9, 3.954584673442066*^9}, {3.954584707597156*^9, 
   3.954584709793357*^9}, {3.954584783570706*^9, 3.954584806033512*^9}, {
   3.9545850203385067`*^9, 3.95458503748709*^9}, {3.954585132898574*^9, 
   3.95458513303367*^9}, {3.954585163236991*^9, 3.954585200289577*^9}, {
   3.954585379174786*^9, 3.954585408790566*^9}, {3.954585690739318*^9, 
   3.9545856958643713`*^9}, {3.954585753740753*^9, 3.954585760336134*^9}, {
   3.954586482905301*^9, 3.954586493455838*^9}, {3.954586787355824*^9, 
   3.954586791987959*^9}, 3.954587902427507*^9, {3.954599399005229*^9, 
   3.9545993997720833`*^9}, {3.9570231189316893`*^9, 3.9570231218989973`*^9}},
 
 CellLabel->"In[1]:=",ExpressionUUID->"b8f74f45-c15f-4d7c-a1c8-4941ffe4cb30"],

Cell[BoxData["8"], "Output",
 CellChangeTimes->{
  3.95304946594304*^9, {3.9530509377198353`*^9, 3.953050947013626*^9}, 
   3.9530511729153*^9, 3.9530513667818317`*^9, 3.953051726023695*^9, 
   3.953051812581814*^9, 3.9530552177856283`*^9, 3.953061007762006*^9, 
   3.953061160870495*^9, 3.953061412295295*^9, 3.953061463196883*^9, 
   3.953061517670691*^9, 3.953061724216177*^9, {3.953061867744631*^9, 
   3.953061887081998*^9}, 3.953061990565425*^9, 3.953062077177804*^9, 
   3.953062126783566*^9, 3.953062445121193*^9, 3.953062846225689*^9, {
   3.953063106131662*^9, 3.9530631349251547`*^9}, 3.953290390960047*^9, 
   3.9532962255094757`*^9, 3.953297243555201*^9, 3.953302452539977*^9, 
   3.953385816485434*^9, 3.953643153170738*^9, 3.953646319597548*^9, {
   3.953646856706209*^9, 3.9536468612415543`*^9}, 3.953646933496873*^9, 
   3.9536470370211363`*^9, 3.953650421318885*^9, 3.953650705367317*^9, 
   3.953650743252458*^9, 3.95365080111652*^9, 3.953650858701754*^9, 
   3.953652641601553*^9, 3.953661539715995*^9, 3.953661786534367*^9, {
   3.9538351329227743`*^9, 3.9538351374393*^9}, 3.954325057143588*^9, 
   3.954500565865561*^9, 3.954500740026779*^9, 3.954583454505681*^9, 
   3.954583945995761*^9, {3.954583984262137*^9, 3.9545840039310007`*^9}, 
   3.954584424889179*^9, 3.954584714336152*^9, 3.9545848111623363`*^9, {
   3.954585025149413*^9, 3.9545850434801197`*^9}, 3.9545851397798843`*^9, 
   3.954585205754314*^9, 3.954585345403721*^9, {3.954585697152679*^9, 
   3.9545857023503428`*^9}, 3.9545857651110573`*^9, 3.95458986482782*^9, 
   3.954595903208683*^9, 3.954599249043483*^9, 3.954599405035039*^9, 
   3.954600207759912*^9, 3.954600238978705*^9, 3.954600499014534*^9, 
   3.956318496265892*^9, 3.9570231492977533`*^9, 3.9572803983580513`*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"665d84fd-74ba-4bbe-8371-e4f7d3689c6c"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Tricritical ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["Ising",
     FontWeight->"Bold"], "2"], TraditionalForm]],ExpressionUUID->
  "5e22013e-d2f7-4ce9-8837-8bcc79516479"],
 StyleBox[" Gauged under Exchange ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["Z", FontSlant -> "Plain"], "2"], TraditionalForm], 
     "errors" -> {}, "input" -> "\\mathbb{Z}_2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e4146be9-a500-4771-9265-75fdc8a46f9f"],
 ".\nThe gauged partition function in this case is given by"
}], "Text",
 CellChangeTimes->{{3.952456199018654*^9, 3.952456300675765*^9}, {
   3.952456348795568*^9, 3.952456349797147*^9}, 
   3.9524563906534224`*^9},ExpressionUUID->"374f45fe-8e7a-4c71-b67a-\
656f45063b90"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Z", "[", "\[Tau]", "]"}], "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Z", "[", "\[Tau]", "]"}], "2"], "+", 
      RowBox[{"Z", "[", 
       RowBox[{"2", "\[Tau]"}], "]"}], "+", 
      RowBox[{"Z", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], "2"], "\[Tau]"}], "]"}], "+", 
      RowBox[{"Z", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], "\[Tau]"}], "+", 
        FractionBox["1", "2"]}], "]"}]}], ")"}]}]}], 
  "\[LineSeparator]"}]], "DisplayFormula",
 CellChangeTimes->{{3.952456419063636*^9, 3.952456557477478*^9}, {
  3.952725553991663*^9, 
  3.952725555247624*^9}},ExpressionUUID->"b577fee4-116d-4870-b091-\
10112f2ae5a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#", ",", "#", ",", "1"}], "}"}], " ", "&"}], "/@", "H"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "20"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.952433915822617*^9, 3.952434016996024*^9}, {
   3.952434065295156*^9, 3.9524340736927443`*^9}, {3.9524341601585417`*^9, 
   3.952434163847827*^9}, {3.952434195262787*^9, 3.9524341991094723`*^9}, {
   3.952434352088312*^9, 3.9524343590456944`*^9}, 3.952434393841929*^9, {
   3.952434623511971*^9, 3.952434689182941*^9}, {3.952434755153037*^9, 
   3.95243482759242*^9}, {3.952434867659783*^9, 3.952434876496973*^9}, {
   3.952434971092966*^9, 3.95243497587549*^9}, {3.952435196598987*^9, 
   3.9524352025488777`*^9}, {3.9524352393240137`*^9, 3.952435240779393*^9}, {
   3.952435357791891*^9, 3.9524353631154833`*^9}, {3.9524354008500643`*^9, 
   3.952435480364259*^9}, {3.952435517927291*^9, 3.9524355593471813`*^9}, {
   3.952435619535722*^9, 3.952435641411233*^9}, {3.9524356814899683`*^9, 
   3.952435734057809*^9}, {3.952435784605789*^9, 3.952435809579179*^9}, {
   3.952435916645651*^9, 3.952435919050962*^9}, {3.952435989927023*^9, 
   3.952435994853648*^9}, {3.9524360417493668`*^9, 3.95243608267483*^9}, {
   3.9524362233248167`*^9, 3.9524362674033813`*^9}, {3.952437565374578*^9, 
   3.952437652462473*^9}, {3.952437772327382*^9, 3.952437786390828*^9}, {
   3.952438403297928*^9, 3.952438403401023*^9}, {3.952438487949122*^9, 
   3.9524385106819897`*^9}, {3.952438691835361*^9, 3.952438738754806*^9}, {
   3.9524390401749697`*^9, 3.9524390841972713`*^9}, {3.952439181357113*^9, 
   3.952439185533556*^9}, {3.952439329391169*^9, 3.952439329614087*^9}, {
   3.952446809457161*^9, 3.952446847723175*^9}, {3.952447158543276*^9, 
   3.952447161917705*^9}, {3.9524548358865767`*^9, 3.9524548729846354`*^9}, {
   3.952455123116084*^9, 3.952455123258103*^9}, {3.9524555719593067`*^9, 
   3.9524555764344397`*^9}, {3.952455707988489*^9, 3.952455708028158*^9}, {
   3.952456119383212*^9, 3.952456119502453*^9}, {3.952692614472447*^9, 
   3.952692614646626*^9}, {3.952693710979048*^9, 3.952693711267589*^9}, {
   3.9526940003911448`*^9, 3.952694014029456*^9}, {3.952694061535205*^9, 
   3.9526940622619267`*^9}, {3.95269410552488*^9, 3.952694110086143*^9}, {
   3.95269424430405*^9, 3.952694244414818*^9}, {3.9526944343688993`*^9, 
   3.952694437431185*^9}, {3.9526946234276237`*^9, 3.952694645311244*^9}, 
   3.952694779954604*^9, {3.952694816588463*^9, 3.9526948485140963`*^9}, {
   3.952695131258168*^9, 3.952695140310421*^9}, {3.952695188244122*^9, 
   3.952695199301545*^9}, {3.95269535285423*^9, 3.952695365932309*^9}, {
   3.952695604279915*^9, 3.952695620502804*^9}, {3.9526970795278873`*^9, 
   3.952697087327807*^9}, 3.9526975581860237`*^9, 3.952697607739073*^9, {
   3.952697727057188*^9, 3.952697727108987*^9}, {3.952706311882955*^9, 
   3.952706313176426*^9}, {3.9527085865343103`*^9, 3.952708602727771*^9}, {
   3.9527086753599*^9, 3.952708788666689*^9}, {3.952708844994256*^9, 
   3.952708856378181*^9}, {3.952709107499382*^9, 3.9527091842681513`*^9}, {
   3.952709260793213*^9, 3.952709260904011*^9}, {3.952709315437893*^9, 
   3.9527093213802137`*^9}, {3.952709436046671*^9, 3.95270945875414*^9}, {
   3.953045329595759*^9, 3.953045366734926*^9}, {3.953045983710721*^9, 
   3.953046038341395*^9}, {3.9530509530928297`*^9, 3.953050956707397*^9}, {
   3.953051184183791*^9, 3.953051190841364*^9}, {3.953061763016924*^9, 
   3.953061763137018*^9}, {3.953061985860839*^9, 3.953061985940249*^9}, {
   3.9532904074825974`*^9, 3.953290411383522*^9}, {3.953297256861244*^9, 
   3.95329726094886*^9}, {3.953303088093213*^9, 3.9533030882072897`*^9}, {
   3.953643159610794*^9, 3.9536431606823463`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"cc8849a8-0310-45a9-906f-41b7d76f2d17"],

Cell[TextData[{
 StyleBox["\nTricritical ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["Ising",
     FontWeight->"Bold"], "2"], TraditionalForm]],ExpressionUUID->
  "17c97676-1719-4345-ae5f-d92fc53dc910"],
 StyleBox[" Gauged under ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[<|"boxes" -> FormBox[
        SubscriptBox[
         StyleBox["Z", FontSlant -> "Plain"], "2"], TraditionalForm], 
      "errors" -> {}, "input" -> "\\mathbb{Z}_2", "state" -> "Boxes"|>,
     "TeXAssistantTemplate"], "x", " ", 
    SubscriptBox["Z", "2"], "_"}], TraditionalForm]],ExpressionUUID->
  "fd34e41c-55ea-4d05-8f4e-40ef87934837"],
 ".\nIn this case we are gauging a double copy of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "2"], TraditionalForm]],ExpressionUUID->
  "ce2448bb-4e1d-48e7-b065-ffa5cb143a16"],
 " one by exchange and one by taking the mutual ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "2"], TraditionalForm]],ExpressionUUID->
  "9a621844-59b0-4832-80ed-4297b1bac60c"],
 " of both."
}], "Text",
 CellChangeTimes->{{3.952456199018654*^9, 3.952456300675765*^9}, {
   3.952456348795568*^9, 3.952456349797147*^9}, 3.9524563906534224`*^9, {
   3.9524573090845127`*^9, 3.952457399561554*^9}, {3.953650860763542*^9, 
   3.953650861931716*^9}},ExpressionUUID->"a0e42558-53e7-425f-a96f-\
ebe905fa3a90"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Hf", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"H", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mf", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#", ",", "#", ",", "1"}], "}"}], "&"}], "/@", "Hf"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.952695648262635*^9, 3.952695669060946*^9}, {
   3.952695699437481*^9, 3.952695699788515*^9}, {3.9526957354690237`*^9, 
   3.952695752013399*^9}, {3.952695819999383*^9, 3.9526958754235907`*^9}, {
   3.952695950024568*^9, 3.9526960078481894`*^9}, 3.952696086458791*^9, 
   3.952696125770094*^9, 3.952697627055532*^9, {3.95269771781618*^9, 
   3.9526977178782053`*^9}, {3.95269781130455*^9, 3.95269781543301*^9}, 
   3.9527022551910152`*^9, {3.952704308600662*^9, 3.952704314192891*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"99f87e43-4483-4a64-9013-cfb7c739bc83"],

Cell[TextData[{
 StyleBox["\nCalculating the Partition Function Matrix\n",
  FontWeight->"Bold"],
 "It is easy to obtain the S and T matrices of the Tricritical Ising model \
and by extension we can obtain them for the squared version simply by taking \
their tensor product with themselves. "
}], "Text",
 CellChangeTimes->{{3.952702273673326*^9, 
  3.952702358392956*^9}},ExpressionUUID->"e8589dbc-d184-41eb-9981-\
748bb4303445"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "i_", "]"}], ":=", 
   RowBox[{"H", "[", 
    RowBox[{"[", 
     RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s", "[", "i_", "]"}], ":=", 
   RowBox[{"H", "[", 
    RowBox[{"[", 
     RowBox[{"i", ",", "2"}], "]"}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", " ", "=", " ", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["2", 
           RowBox[{"p", " ", 
            RowBox[{"p", "'"}]}]], ")"}], 
         FractionBox["1", "2"]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", " ", "+", " ", 
          RowBox[{
           RowBox[{"s", "[", "#1", "]"}], " ", 
           RowBox[{"r", "[", "#2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"r", "[", "#1", "]"}], " ", 
           RowBox[{"s", "[", "#2", "]"}]}]}]], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Pi]", " ", 
          FractionBox["p", 
           RowBox[{"p", "'"}]], 
          RowBox[{"r", "[", "#1", "]"}], " ", 
          RowBox[{"r", "[", "#2", "]"}]}], "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Pi]", " ", 
          FractionBox[
           RowBox[{"p", "'"}], "p"], 
          RowBox[{"s", "[", "#1", "]"}], " ", 
          RowBox[{"s", "[", "#2", "]"}]}], "]"}]}], " ", ")"}], " ", "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "H", "]"}], ",", 
       RowBox[{"Length", "[", "H", "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        TemplateBox[{
          RowBox[{
            RowBox[{"r", "[", "#1", "]"}], "-", 
            RowBox[{"r", "[", "#2", "]"}]}]},
         "KroneckerDeltaSeq"], 
        TemplateBox[{
          RowBox[{
            RowBox[{"s", "[", "#1", "]"}], "-", 
            RowBox[{"s", "[", "#2", "]"}]}]},
         "KroneckerDeltaSeq"], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"h", "[", 
             RowBox[{
              RowBox[{"r", "[", "#1", "]"}], ",", 
              RowBox[{"s", "[", "#1", "]"}]}], "]"}], "-", 
            FractionBox["c", "24"]}], ")"}]}]]}], ")"}], " ", "&"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "H", "]"}], ",", 
       RowBox[{"Length", "[", "H", "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sf", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"S", ",", "S"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tf", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"T", ",", "T"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.952702360852242*^9, 3.95270236110399*^9}, {
  3.952702418447236*^9, 3.952702429721712*^9}, {3.95270249680376*^9, 
  3.9527025009454117`*^9}, {3.95270253688461*^9, 3.9527025411074963`*^9}, {
  3.952702595996286*^9, 3.9527026857570143`*^9}, {3.952702734358069*^9, 
  3.9527027822218723`*^9}, {3.952702833958012*^9, 3.952702927038577*^9}, {
  3.952703017902732*^9, 3.95270313868754*^9}, {3.9527037631463957`*^9, 
  3.952703764113984*^9}, {3.9527038298737087`*^9, 3.9527040666559677`*^9}, {
  3.952704323307536*^9, 3.952704325778823*^9}, {3.952718823416007*^9, 
  3.95271883362182*^9}, {3.95272234274794*^9, 3.952722349620833*^9}, {
  3.953046622794774*^9, 3.953046624161532*^9}, {3.953056346988452*^9, 
  3.9530563485446453`*^9}, {3.953057004512982*^9, 3.953057010755025*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"bdcf6f15-56e2-4b46-8bbd-f6586704e123"],

Cell[TextData[{
 "\n",
 StyleBox["Define the Transformation Matrices with Respect to the Insertions\n\
",
  FontWeight->"Bold"],
 "When we insert a defect along the \[OpenCurlyDoubleQuote]spacelike\
\[CloseCurlyDoubleQuote] direction we are effectively multiplying the \
characters with some matrix. Here is how to find it."
}], "Text",
 CellChangeTimes->{{3.9527041677902937`*^9, 
  3.9527042290807123`*^9}},ExpressionUUID->"081aedb1-6382-4ed5-b67e-\
9e7217a96752"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        TemplateBox[{
          RowBox[{
            RowBox[{"Hf", "[", 
              RowBox[{"[", 
                RowBox[{"#1", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"Hf", "[", 
              RowBox[{"[", 
                RowBox[{"#1", ",", "2"}], "]"}], "]"}]}]},
         "KroneckerDeltaSeq"], 
        TemplateBox[{
          RowBox[{
            RowBox[{"Hf", "[", 
              RowBox[{"[", 
                RowBox[{"#2", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"Hf", "[", 
              RowBox[{"[", 
                RowBox[{"#2", ",", "2"}], "]"}], "]"}]}]},
         "KroneckerDeltaSeq"]}], ")"}], " ", "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "Hf", "]"}], ",", 
       RowBox[{"Length", "[", "Hf", "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[DoubleStruckL]", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        RowBox[{
          RowBox[{"H", "[", 
            RowBox[{"[", "#1", "]"}], "]"}], ",", 
          RowBox[{"H", "[", 
            RowBox[{"[", "#2", "]"}], "]"}]}]},
       "KroneckerDeltaSeq"], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "H", "]"}], ",", 
       RowBox[{"Length", "[", "H", "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[DoubleStruckL]f", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"\[DoubleStruckL]", ",", "\[DoubleStruckL]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "+", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]], "&"}], "/@", "H"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]", "'"}], "=", " ", 
   RowBox[{
    RowBox[{"S", ".", " ", "\[Eta]", " ", ".", "S"}], " ", "//", " ", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]\[Eta]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "\[Conjugate]"}], " ", ".", " ", 
     RowBox[{"\[Eta]", "'"}], " ", ".", " ", "T"}], " ", "//", " ", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]f", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"\[Eta]", ",", "\[Eta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]f", "'"}], "=", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"\[Eta]", "'"}], ",", 
      RowBox[{"\[Eta]", "'"}]}], "]"}], "//", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]f\[Eta]f", "=", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"\[Eta]\[Eta]", ",", "\[Eta]\[Eta]"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.952720458343906*^9, 3.9527206063672543`*^9}, {
   3.952720637693067*^9, 3.952720816415695*^9}, {3.952720846872044*^9, 
   3.952720886911365*^9}, {3.952721044599452*^9, 3.952721112759622*^9}, {
   3.9527220447782583`*^9, 3.9527220461913853`*^9}, 3.952722488361444*^9, {
   3.952724487816082*^9, 3.952724493014123*^9}, {3.953044461450616*^9, 
   3.953044467734514*^9}, {3.953294810714677*^9, 3.953294964079955*^9}, {
   3.953296113707159*^9, 3.953296129356249*^9}, {3.953296232058964*^9, 
   3.9532962386363487`*^9}, {3.953296410697639*^9, 3.953296427284816*^9}, {
   3.953296459539136*^9, 3.953296560241824*^9}, {3.953297279242807*^9, 
   3.953297347133979*^9}, {3.953297384924684*^9, 3.9532974842611237`*^9}, {
   3.953302498414256*^9, 3.953302540853655*^9}, {3.953302610190806*^9, 
   3.953302649678047*^9}, {3.953302691287311*^9, 3.95330271247056*^9}, {
   3.953302749239044*^9, 3.95330276060435*^9}, {3.953302880409575*^9, 
   3.95330288149572*^9}, {3.9533029189834967`*^9, 3.9533029201058407`*^9}, {
   3.953303059754876*^9, 3.953303062433043*^9}, {3.953645969068028*^9, 
   3.953645972145623*^9}, {3.9536466078619432`*^9, 3.9536466768957367`*^9}, {
   3.953646737558893*^9, 3.953646741671275*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"44a5f4ed-63e0-41ba-92fc-28cd5913f879"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Eta]", "'"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.9570231550371447`*^9, 3.957023184399324*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"7aa1467e-1277-4fc8-ad53-8202fcf8d7c9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "1", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0"},
     {"1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.957023162065151*^9, 3.957023185018044*^9}, 
   3.95728039869415*^9},
 CellLabel->
  "Out[35]//MatrixForm=",ExpressionUUID->"047a9800-b136-4ed9-8de2-\
20f3b647920a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.953654079294455*^9, 3.9536540802548*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"b470888c-d7cb-4aee-9e55-92b125b5a46b"],

Cell[TextData[{
 StyleBox["Calculating the Gauged Partition Function",
  FontWeight->"Bold"],
 "\nWe finally have all the ingredients to calculate the Gauged Partition \
function under exchange and the shared ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "2"], TraditionalForm]],ExpressionUUID->
  "294822df-4df1-4a17-bd4a-c1c3d3d45392"],
 " symmetries."
}], "Text",
 CellChangeTimes->{{3.953295057639447*^9, 3.953295132411652*^9}, {
   3.95329517433956*^9, 3.953295196588252*^9}, 
   3.953646837202869*^9},ExpressionUUID->"3d9cada3-2cd3-4e5a-8d77-\
31973a113626"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"terms", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", ",", "\[DoubleStruckL]f", ",", "Hf", ",", "\[Chi]f"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", "2"], ",", "\[DoubleStruckL]", ",", "H", ",", 
       "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", 
        FractionBox["1", "2"]], ",", "\[DoubleStruckL]", ",", "H", ",", 
       "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["q", 
         FractionBox["1", "2"]]}], ",", "\[DoubleStruckL]", ",", "H", ",", 
       "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", "2"], ",", "\[DoubleStruckL]", ",", "H", ",", 
       "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", 
        FractionBox["1", "2"]], ",", "\[DoubleStruckL]", ",", "H", ",", 
       "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["q", 
         FractionBox["1", "2"]]}], ",", "\[DoubleStruckL]", ",", "H", ",", 
       "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", "\[Eta]f", ",", "Hf", ",", "\[Chi]f"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", 
       RowBox[{"\[Eta]f", "'"}], ",", "Hf", ",", "\[Chi]f"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", "\[Eta]f\[Eta]f", ",", "Hf", ",", "\[Chi]f"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", "2"], ",", 
       RowBox[{"\[Eta]", "'"}], ",", "H", ",", "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", 
        FractionBox["1", "2"]], ",", "\[Eta]", ",", "H", ",", "\[Chi]"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["q", 
         FractionBox["1", "2"]]}], ",", "\[Eta]", ",", "H", ",", "\[Chi]"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", "2"], ",", 
       RowBox[{"\[Eta]", "'"}], ",", "H", ",", "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", 
        FractionBox["1", "2"]], ",", "\[Eta]", ",", "H", ",", "\[Chi]"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["q", 
         FractionBox["1", "2"]]}], ",", "\[Eta]", ",", "H", ",", "\[Chi]"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Zg", "[", "q_", "]"}], "=", 
  RowBox[{"Zop", "[", 
   RowBox[{"terms", ",", 
    RowBox[{"Truncate", "->", "n"}], ",", 
    RowBox[{"UpToOrder", "->", "5"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.953295225713067*^9, 3.9532954167959127`*^9}, {
   3.953295450973749*^9, 3.95329549608497*^9}, {3.95329559983064*^9, 
   3.953295618045138*^9}, {3.953296597567391*^9, 3.9532966199858522`*^9}, {
   3.9532969330419273`*^9, 3.953296969153378*^9}, {3.953297508526071*^9, 
   3.953297672211475*^9}, {3.95329774070958*^9, 3.953297763829784*^9}, {
   3.9532980440250807`*^9, 3.953298060662937*^9}, {3.953299821134066*^9, 
   3.9532998611968184`*^9}, {3.953299923093376*^9, 3.953299939405038*^9}, {
   3.9532999847329617`*^9, 3.953300094782651*^9}, {3.9533001417332697`*^9, 
   3.953300142555431*^9}, {3.953302929696287*^9, 3.95330293811197*^9}, {
   3.953303067021763*^9, 3.953303067173292*^9}, 3.9536315659979553`*^9, {
   3.9536317044880037`*^9, 3.953631718141501*^9}, {3.9536317482869463`*^9, 
   3.953631831246079*^9}, {3.953631892079077*^9, 3.9536318943741093`*^9}, {
   3.953632038078021*^9, 3.9536320381754827`*^9}, {3.953644871056406*^9, 
   3.9536448993271837`*^9}, {3.953644933752631*^9, 3.953644934295169*^9}, 
   3.953645917308834*^9, {3.953646867449616*^9, 3.95364686869396*^9}, {
   3.953647002576901*^9, 3.953647019138103*^9}, {3.953649913019782*^9, 
   3.9536499132099133`*^9}, {3.953650903840213*^9, 3.953650960517556*^9}, {
   3.953651238604855*^9, 3.953651279749168*^9}, 3.953651427994465*^9, {
   3.95365247407121*^9, 3.9536524859650383`*^9}, {3.953653172708395*^9, 
   3.953653173314294*^9}, {3.953656309777939*^9, 3.953656309990198*^9}, {
   3.953656405616262*^9, 3.953656439045225*^9}, {3.953657012972458*^9, 
   3.953657073246707*^9}, 3.9536580436962023`*^9, {3.9536584848225307`*^9, 
   3.953658535330315*^9}, {3.953661565005146*^9, 3.953661567798129*^9}, {
   3.953661742358471*^9, 3.953661746793635*^9}, 3.95432396858244*^9, {
   3.954328901628734*^9, 3.954328906942656*^9}, {3.954330531217628*^9, 
   3.954330537529911*^9}, {3.954330823543791*^9, 3.954330823730229*^9}, {
   3.954331296386503*^9, 3.9543312965957203`*^9}, {3.95433153813988*^9, 
   3.9543315415360413`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"6a764216-d3ea-4918-a22a-11788dd8b634"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox["q", 
    RowBox[{"7", "/", "60"}]]], "+", 
  FractionBox["2", 
   SuperscriptBox["q", 
    RowBox[{"7", "/", "240"}]]], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"1", "/", "30"}]]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"17", "/", "240"}]]}], "+", 
  SuperscriptBox["q", 
   RowBox[{"1", "/", "12"}]], "+", 
  SuperscriptBox["q", 
   RowBox[{"17", "/", "60"}]], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"137", "/", "240"}]]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"5", "/", "6"}]]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q", 
    RowBox[{"233", "/", "240"}]]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q", 
    RowBox[{"31", "/", "30"}]]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["q", 
    RowBox[{"257", "/", "240"}]]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["q", 
    RowBox[{"13", "/", "12"}]]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["q", 
    RowBox[{"77", "/", "60"}]]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"353", "/", "240"}]]}], "+", 
  RowBox[{"10", " ", 
   SuperscriptBox["q", 
    RowBox[{"377", "/", "240"}]]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"49", "/", "30"}]]}], "+", 
  RowBox[{"8", " ", 
   SuperscriptBox["q", 
    RowBox[{"11", "/", "6"}]]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"113", "/", "60"}]]}], "+", 
  RowBox[{"10", " ", 
   SuperscriptBox["q", 
    RowBox[{"473", "/", "240"}]]}], "+", 
  RowBox[{"16", " ", 
   SuperscriptBox["q", 
    RowBox[{"61", "/", "30"}]]}], "+", 
  RowBox[{"22", " ", 
   SuperscriptBox["q", 
    RowBox[{"497", "/", "240"}]]}], "+", 
  RowBox[{"11", " ", 
   SuperscriptBox["q", 
    RowBox[{"25", "/", "12"}]]}], "+", 
  RowBox[{"19", " ", 
   SuperscriptBox["q", 
    RowBox[{"137", "/", "60"}]]}], "+", 
  RowBox[{"10", " ", 
   SuperscriptBox["q", 
    RowBox[{"593", "/", "240"}]]}], "+", 
  RowBox[{"32", " ", 
   SuperscriptBox["q", 
    RowBox[{"617", "/", "240"}]]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q", 
    RowBox[{"79", "/", "30"}]]}], "+", 
  RowBox[{"24", " ", 
   SuperscriptBox["q", 
    RowBox[{"17", "/", "6"}]]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["q", 
    RowBox[{"173", "/", "60"}]]}], "+", 
  RowBox[{"26", " ", 
   SuperscriptBox["q", 
    RowBox[{"713", "/", "240"}]]}], "+", 
  RowBox[{"40", " ", 
   SuperscriptBox["q", 
    RowBox[{"91", "/", "30"}]]}], "+", 
  RowBox[{"60", " ", 
   SuperscriptBox["q", 
    RowBox[{"737", "/", "240"}]]}], "+", 
  RowBox[{"32", " ", 
   SuperscriptBox["q", 
    RowBox[{"37", "/", "12"}]]}], "+", 
  RowBox[{"52", " ", 
   SuperscriptBox["q", 
    RowBox[{"197", "/", "60"}]]}], "+", 
  RowBox[{"28", " ", 
   SuperscriptBox["q", 
    RowBox[{"833", "/", "240"}]]}], "+", 
  RowBox[{"88", " ", 
   SuperscriptBox["q", 
    RowBox[{"857", "/", "240"}]]}], "+", 
  RowBox[{"12", " ", 
   SuperscriptBox["q", 
    RowBox[{"109", "/", "30"}]]}], "+", 
  RowBox[{"64", " ", 
   SuperscriptBox["q", 
    RowBox[{"23", "/", "6"}]]}], "+", 
  RowBox[{"14", " ", 
   SuperscriptBox["q", 
    RowBox[{"233", "/", "60"}]]}], "+", 
  RowBox[{"60", " ", 
   SuperscriptBox["q", 
    RowBox[{"953", "/", "240"}]]}], "+", 
  RowBox[{"106", " ", 
   SuperscriptBox["q", 
    RowBox[{"121", "/", "30"}]]}], "+", 
  RowBox[{"150", " ", 
   SuperscriptBox["q", 
    RowBox[{"977", "/", "240"}]]}], "+", 
  RowBox[{"81", " ", 
   SuperscriptBox["q", 
    RowBox[{"49", "/", "12"}]]}], "+", 
  RowBox[{"127", " ", 
   SuperscriptBox["q", 
    RowBox[{"257", "/", "60"}]]}], "+", 
  RowBox[{"72", " ", 
   SuperscriptBox["q", 
    RowBox[{"1073", "/", "240"}]]}], "+", 
  RowBox[{"216", " ", 
   SuperscriptBox["q", 
    RowBox[{"1097", "/", "240"}]]}], "+", 
  RowBox[{"24", " ", 
   SuperscriptBox["q", 
    RowBox[{"139", "/", "30"}]]}], "+", 
  RowBox[{"152", " ", 
   SuperscriptBox["q", 
    RowBox[{"29", "/", "6"}]]}], "+", 
  RowBox[{"32", " ", 
   SuperscriptBox["q", 
    RowBox[{"293", "/", "60"}]]}], "+", 
  RowBox[{"132", " ", 
   SuperscriptBox["q", 
    RowBox[{"1193", "/", "240"}]]}]}]], "Output",
 CellChangeTimes->{{3.953650915315695*^9, 3.953650956888994*^9}, 
   3.9536512179541693`*^9, 3.953651362570558*^9, 3.953651437810164*^9, {
   3.9536524860799017`*^9, 3.9536524887742043`*^9}, {3.9536531680254593`*^9, 
   3.953653174642006*^9}, 3.953656442299334*^9, {3.953657053489314*^9, 
   3.9536570744942007`*^9}, {3.953658530674573*^9, 3.953658536682727*^9}, 
   3.953661541890174*^9, 3.953661586303327*^9, 3.953661789990724*^9, 
   3.953835140370089*^9, 3.954325060419427*^9, 3.954328917816876*^9, 
   3.954330815734346*^9, 3.95433100824689*^9, 3.95433143207006*^9, 
   3.954331559679034*^9, 3.954500569527711*^9, 3.9563185658156977`*^9, 
   3.957280401776173*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"eefbc07f-e86a-41a6-98f5-dd121b191a04"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"terms", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", ",", "\[DoubleStruckL]f", ",", "Hf", ",", "\[Chi]f"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", "2"], ",", "\[DoubleStruckL]", ",", "H", ",", 
       "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", 
        FractionBox["1", "2"]], ",", "\[DoubleStruckL]", ",", "H", ",", 
       "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["q", 
         FractionBox["1", "2"]]}], ",", "\[DoubleStruckL]", ",", "H", ",", 
       "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", "2"], ",", "\[DoubleStruckL]", ",", "H", ",", 
       "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", 
        FractionBox["1", "2"]], ",", "\[DoubleStruckL]", ",", "H", ",", 
       "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["q", 
         FractionBox["1", "2"]]}], ",", "\[DoubleStruckL]", ",", "H", ",", 
       "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", "\[Eta]f", ",", "Hf", ",", "\[Chi]f"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", 
       RowBox[{"\[Eta]f", "'"}], ",", "Hf", ",", "\[Chi]f"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", "\[Eta]f\[Eta]f", ",", "Hf", ",", "\[Chi]f"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", "2"], ",", 
       RowBox[{"-", 
        RowBox[{"\[Eta]", "'"}]}], ",", "H", ",", "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", 
        FractionBox["1", "2"]], ",", 
       RowBox[{"-", "\[Eta]"}], ",", "H", ",", "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["q", 
         FractionBox["1", "2"]]}], ",", 
       RowBox[{"-", "\[Eta]"}], ",", "H", ",", "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", "2"], ",", 
       RowBox[{"-", 
        RowBox[{"\[Eta]", "'"}]}], ",", "H", ",", "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", 
        FractionBox["1", "2"]], ",", 
       RowBox[{"-", "\[Eta]"}], ",", "H", ",", "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["q", 
         FractionBox["1", "2"]]}], ",", 
       RowBox[{"-", "\[Eta]"}], ",", "H", ",", "\[Chi]"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ze", "[", "q_", "]"}], "=", 
  RowBox[{"Zop", "[", 
   RowBox[{"terms", ",", 
    RowBox[{"Truncate", "->", "n"}], ",", 
    RowBox[{"UpToOrder", "->", "5"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.953295225713067*^9, 3.9532954167959127`*^9}, {
   3.953295450973749*^9, 3.95329549608497*^9}, {3.95329559983064*^9, 
   3.953295618045138*^9}, {3.953296597567391*^9, 3.9532966199858522`*^9}, {
   3.9532969330419273`*^9, 3.953296969153378*^9}, {3.953297508526071*^9, 
   3.953297672211475*^9}, {3.95329774070958*^9, 3.953297763829784*^9}, {
   3.9532980440250807`*^9, 3.953298060662937*^9}, {3.953299821134066*^9, 
   3.9532998611968184`*^9}, {3.953299923093376*^9, 3.953299939405038*^9}, {
   3.9532999847329617`*^9, 3.953300094782651*^9}, {3.9533001417332697`*^9, 
   3.953300142555431*^9}, {3.953302929696287*^9, 3.95330293811197*^9}, {
   3.953303067021763*^9, 3.953303067173292*^9}, 3.9536315659979553`*^9, {
   3.9536317044880037`*^9, 3.953631718141501*^9}, {3.9536317482869463`*^9, 
   3.953631831246079*^9}, {3.953631892079077*^9, 3.9536318943741093`*^9}, {
   3.953632038078021*^9, 3.9536320381754827`*^9}, {3.953644871056406*^9, 
   3.9536448993271837`*^9}, {3.953644933752631*^9, 3.953644934295169*^9}, 
   3.953645917308834*^9, {3.953646867449616*^9, 3.95364686869396*^9}, {
   3.953647002576901*^9, 3.953647019138103*^9}, {3.953649913019782*^9, 
   3.9536499132099133`*^9}, {3.953650903840213*^9, 3.953650960517556*^9}, {
   3.953651238604855*^9, 3.953651279749168*^9}, 3.953651427994465*^9, {
   3.95365247407121*^9, 3.9536524859650383`*^9}, {3.953653172708395*^9, 
   3.953653173314294*^9}, {3.953656309777939*^9, 3.953656309990198*^9}, {
   3.953656405616262*^9, 3.953656439045225*^9}, {3.953657012972458*^9, 
   3.953657073246707*^9}, 3.9536580436962023`*^9, {3.9536584848225307`*^9, 
   3.953658535330315*^9}, {3.953661565005146*^9, 3.953661567798129*^9}, {
   3.953661742358471*^9, 3.953661746793635*^9}, 3.95432396858244*^9, {
   3.954328699682373*^9, 3.9543287018752117`*^9}, {3.9543287456186733`*^9, 
   3.9543287494033737`*^9}, {3.95432881083074*^9, 3.954328816302264*^9}, {
   3.954328862867281*^9, 3.954328911681831*^9}, {3.954330094035634*^9, 
   3.9543301574557056`*^9}, {3.954330534971298*^9, 3.954330543710908*^9}, {
   3.9543308285126953`*^9, 3.9543308286189947`*^9}, {3.954331306818472*^9, 
   3.9543313111633987`*^9}, {3.9543315477892237`*^9, 3.954331552909349*^9}, {
   3.954500519330978*^9, 3.954500521289523*^9}, {3.954500900469331*^9, 
   3.9545009185866947`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"064d08d2-c4af-4685-b9c2-1cdb6cd66691"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox["q", 
    RowBox[{"7", "/", "60"}]]], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"1", "/", "120"}]]}], "+", 
  SuperscriptBox["q", 
   RowBox[{"1", "/", "30"}]], "+", 
  SuperscriptBox["q", 
   RowBox[{"1", "/", "12"}]], "+", 
  SuperscriptBox["q", 
   RowBox[{"17", "/", "60"}]], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"49", "/", "120"}]]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"5", "/", "6"}]]}], "+", 
  RowBox[{"10", " ", 
   SuperscriptBox["q", 
    RowBox[{"121", "/", "120"}]]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q", 
    RowBox[{"31", "/", "30"}]]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["q", 
    RowBox[{"13", "/", "12"}]]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q", 
    RowBox[{"77", "/", "60"}]]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["q", 
    RowBox[{"169", "/", "120"}]]}], "+", 
  SuperscriptBox["q", 
   RowBox[{"49", "/", "30"}]], "+", 
  RowBox[{"8", " ", 
   SuperscriptBox["q", 
    RowBox[{"11", "/", "6"}]]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"113", "/", "60"}]]}], "+", 
  RowBox[{"36", " ", 
   SuperscriptBox["q", 
    RowBox[{"241", "/", "120"}]]}], "+", 
  RowBox[{"14", " ", 
   SuperscriptBox["q", 
    RowBox[{"61", "/", "30"}]]}], "+", 
  RowBox[{"11", " ", 
   SuperscriptBox["q", 
    RowBox[{"25", "/", "12"}]]}], "+", 
  RowBox[{"19", " ", 
   SuperscriptBox["q", 
    RowBox[{"137", "/", "60"}]]}], "+", 
  RowBox[{"22", " ", 
   SuperscriptBox["q", 
    RowBox[{"289", "/", "120"}]]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q", 
    RowBox[{"79", "/", "30"}]]}], "+", 
  RowBox[{"24", " ", 
   SuperscriptBox["q", 
    RowBox[{"17", "/", "6"}]]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q", 
    RowBox[{"173", "/", "60"}]]}], "+", 
  RowBox[{"106", " ", 
   SuperscriptBox["q", 
    RowBox[{"361", "/", "120"}]]}], "+", 
  RowBox[{"40", " ", 
   SuperscriptBox["q", 
    RowBox[{"91", "/", "30"}]]}], "+", 
  RowBox[{"32", " ", 
   SuperscriptBox["q", 
    RowBox[{"37", "/", "12"}]]}], "+", 
  RowBox[{"48", " ", 
   SuperscriptBox["q", 
    RowBox[{"197", "/", "60"}]]}], "+", 
  RowBox[{"60", " ", 
   SuperscriptBox["q", 
    RowBox[{"409", "/", "120"}]]}], "+", 
  RowBox[{"10", " ", 
   SuperscriptBox["q", 
    RowBox[{"109", "/", "30"}]]}], "+", 
  RowBox[{"64", " ", 
   SuperscriptBox["q", 
    RowBox[{"23", "/", "6"}]]}], "+", 
  RowBox[{"14", " ", 
   SuperscriptBox["q", 
    RowBox[{"233", "/", "60"}]]}], "+", 
  RowBox[{"272", " ", 
   SuperscriptBox["q", 
    RowBox[{"481", "/", "120"}]]}], "+", 
  RowBox[{"101", " ", 
   SuperscriptBox["q", 
    RowBox[{"121", "/", "30"}]]}], "+", 
  RowBox[{"81", " ", 
   SuperscriptBox["q", 
    RowBox[{"49", "/", "12"}]]}], "+", 
  RowBox[{"127", " ", 
   SuperscriptBox["q", 
    RowBox[{"257", "/", "60"}]]}], "+", 
  RowBox[{"146", " ", 
   SuperscriptBox["q", 
    RowBox[{"529", "/", "120"}]]}], "+", 
  RowBox[{"24", " ", 
   SuperscriptBox["q", 
    RowBox[{"139", "/", "30"}]]}], "+", 
  RowBox[{"152", " ", 
   SuperscriptBox["q", 
    RowBox[{"29", "/", "6"}]]}], "+", 
  RowBox[{"30", " ", 
   SuperscriptBox["q", 
    RowBox[{"293", "/", "60"}]]}]}]], "Output",
 CellChangeTimes->{{3.9543315618415813`*^9, 3.954331563942827*^9}, 
   3.9545005715878763`*^9, 3.954500921824617*^9, 3.9563185757185097`*^9, 
   3.957280404922181*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"079d1135-b7ac-4b8e-8d6d-4dc538509fac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"terms", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", ",", "\[DoubleStruckL]f", ",", "Hf", ",", "\[Chi]f"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", "2"], ",", "\[DoubleStruckL]", ",", "H", ",", 
       "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q", 
        FractionBox["1", "2"]], ",", "\[DoubleStruckL]", ",", "H", ",", 
       "\[Chi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["q", 
         FractionBox["1", "2"]]}], ",", "\[DoubleStruckL]", ",", "H", ",", 
       "\[Chi]"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z\[Sigma]", "[", "q_", "]"}], "=", 
  RowBox[{"Zop", "[", 
   RowBox[{"terms", ",", 
    RowBox[{"Truncate", "->", "n"}], ",", 
    RowBox[{"UpToOrder", "->", "5"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.957034774388389*^9, 3.957034775744947*^9}, 
   3.957280285369918*^9, {3.957280350276372*^9, 3.957280379882408*^9}, {
   3.9572805341816*^9, 
   3.95728053577946*^9}},ExpressionUUID->"11b65d1e-019b-46b8-b20e-\
929eaf8f7b66"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox["q", 
    RowBox[{"7", "/", "60"}]]], "+", 
  FractionBox["1", 
   SuperscriptBox["q", 
    RowBox[{"1", "/", "24"}]]], "+", 
  FractionBox["1", 
   SuperscriptBox["q", 
    RowBox[{"7", "/", "240"}]]], "+", 
  SuperscriptBox["q", 
   RowBox[{"1", "/", "120"}]], "+", 
  SuperscriptBox["q", 
   RowBox[{"1", "/", "30"}]], "+", 
  SuperscriptBox["q", 
   RowBox[{"17", "/", "240"}]], "+", 
  SuperscriptBox["q", 
   RowBox[{"1", "/", "12"}]], "+", 
  SuperscriptBox["q", 
   RowBox[{"19", "/", "120"}]], "+", 
  SuperscriptBox["q", 
   RowBox[{"17", "/", "60"}]], "+", 
  SuperscriptBox["q", 
   RowBox[{"49", "/", "120"}]], "+", 
  SuperscriptBox["q", 
   RowBox[{"137", "/", "240"}]], "+", 
  SuperscriptBox["q", 
   RowBox[{"91", "/", "120"}]], "+", 
  SuperscriptBox["q", 
   RowBox[{"5", "/", "6"}]], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["q", 
    RowBox[{"23", "/", "24"}]]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"233", "/", "240"}]]}], "+", 
  RowBox[{"5", " ", 
   SuperscriptBox["q", 
    RowBox[{"121", "/", "120"}]]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"31", "/", "30"}]]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["q", 
    RowBox[{"257", "/", "240"}]]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["q", 
    RowBox[{"13", "/", "12"}]]}], "+", 
  RowBox[{"5", " ", 
   SuperscriptBox["q", 
    RowBox[{"139", "/", "120"}]]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["q", 
    RowBox[{"77", "/", "60"}]]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["q", 
    RowBox[{"169", "/", "120"}]]}], "+", 
  SuperscriptBox["q", 
   RowBox[{"353", "/", "240"}]], "+", 
  RowBox[{"5", " ", 
   SuperscriptBox["q", 
    RowBox[{"377", "/", "240"}]]}], "+", 
  SuperscriptBox["q", 
   RowBox[{"49", "/", "30"}]], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"211", "/", "120"}]]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q", 
    RowBox[{"11", "/", "6"}]]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"113", "/", "60"}]]}], "+", 
  RowBox[{"12", " ", 
   SuperscriptBox["q", 
    RowBox[{"47", "/", "24"}]]}], "+", 
  RowBox[{"5", " ", 
   SuperscriptBox["q", 
    RowBox[{"473", "/", "240"}]]}], "+", 
  RowBox[{"18", " ", 
   SuperscriptBox["q", 
    RowBox[{"241", "/", "120"}]]}], "+", 
  RowBox[{"8", " ", 
   SuperscriptBox["q", 
    RowBox[{"61", "/", "30"}]]}], "+", 
  RowBox[{"11", " ", 
   SuperscriptBox["q", 
    RowBox[{"497", "/", "240"}]]}], "+", 
  RowBox[{"7", " ", 
   SuperscriptBox["q", 
    RowBox[{"25", "/", "12"}]]}], "+", 
  RowBox[{"16", " ", 
   SuperscriptBox["q", 
    RowBox[{"259", "/", "120"}]]}], "+", 
  RowBox[{"11", " ", 
   SuperscriptBox["q", 
    RowBox[{"137", "/", "60"}]]}], "+", 
  RowBox[{"11", " ", 
   SuperscriptBox["q", 
    RowBox[{"289", "/", "120"}]]}], "+", 
  RowBox[{"5", " ", 
   SuperscriptBox["q", 
    RowBox[{"593", "/", "240"}]]}], "+", 
  RowBox[{"16", " ", 
   SuperscriptBox["q", 
    RowBox[{"617", "/", "240"}]]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q", 
    RowBox[{"79", "/", "30"}]]}], "+", 
  RowBox[{"5", " ", 
   SuperscriptBox["q", 
    RowBox[{"331", "/", "120"}]]}], "+", 
  RowBox[{"12", " ", 
   SuperscriptBox["q", 
    RowBox[{"17", "/", "6"}]]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["q", 
    RowBox[{"173", "/", "60"}]]}], "+", 
  RowBox[{"31", " ", 
   SuperscriptBox["q", 
    RowBox[{"71", "/", "24"}]]}], "+", 
  RowBox[{"13", " ", 
   SuperscriptBox["q", 
    RowBox[{"713", "/", "240"}]]}], "+", 
  RowBox[{"53", " ", 
   SuperscriptBox["q", 
    RowBox[{"361", "/", "120"}]]}], "+", 
  RowBox[{"20", " ", 
   SuperscriptBox["q", 
    RowBox[{"91", "/", "30"}]]}], "+", 
  RowBox[{"30", " ", 
   SuperscriptBox["q", 
    RowBox[{"737", "/", "240"}]]}], "+", 
  RowBox[{"20", " ", 
   SuperscriptBox["q", 
    RowBox[{"37", "/", "12"}]]}], "+", 
  RowBox[{"46", " ", 
   SuperscriptBox["q", 
    RowBox[{"379", "/", "120"}]]}], "+", 
  RowBox[{"26", " ", 
   SuperscriptBox["q", 
    RowBox[{"197", "/", "60"}]]}], "+", 
  RowBox[{"30", " ", 
   SuperscriptBox["q", 
    RowBox[{"409", "/", "120"}]]}], "+", 
  RowBox[{"14", " ", 
   SuperscriptBox["q", 
    RowBox[{"833", "/", "240"}]]}], "+", 
  RowBox[{"44", " ", 
   SuperscriptBox["q", 
    RowBox[{"857", "/", "240"}]]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["q", 
    RowBox[{"109", "/", "30"}]]}], "+", 
  RowBox[{"13", " ", 
   SuperscriptBox["q", 
    RowBox[{"451", "/", "120"}]]}], "+", 
  RowBox[{"32", " ", 
   SuperscriptBox["q", 
    RowBox[{"23", "/", "6"}]]}], "+", 
  RowBox[{"10", " ", 
   SuperscriptBox["q", 
    RowBox[{"233", "/", "60"}]]}], "+", 
  RowBox[{"77", " ", 
   SuperscriptBox["q", 
    RowBox[{"95", "/", "24"}]]}], "+", 
  RowBox[{"30", " ", 
   SuperscriptBox["q", 
    RowBox[{"953", "/", "240"}]]}], "+", 
  RowBox[{"136", " ", 
   SuperscriptBox["q", 
    RowBox[{"481", "/", "120"}]]}], "+", 
  RowBox[{"53", " ", 
   SuperscriptBox["q", 
    RowBox[{"121", "/", "30"}]]}], "+", 
  RowBox[{"75", " ", 
   SuperscriptBox["q", 
    RowBox[{"977", "/", "240"}]]}], "+", 
  RowBox[{"45", " ", 
   SuperscriptBox["q", 
    RowBox[{"49", "/", "12"}]]}], "+", 
  RowBox[{"114", " ", 
   SuperscriptBox["q", 
    RowBox[{"499", "/", "120"}]]}], "+", 
  RowBox[{"67", " ", 
   SuperscriptBox["q", 
    RowBox[{"257", "/", "60"}]]}], "+", 
  RowBox[{"73", " ", 
   SuperscriptBox["q", 
    RowBox[{"529", "/", "120"}]]}], "+", 
  RowBox[{"36", " ", 
   SuperscriptBox["q", 
    RowBox[{"1073", "/", "240"}]]}], "+", 
  RowBox[{"108", " ", 
   SuperscriptBox["q", 
    RowBox[{"1097", "/", "240"}]]}], "+", 
  RowBox[{"12", " ", 
   SuperscriptBox["q", 
    RowBox[{"139", "/", "30"}]]}], "+", 
  RowBox[{"30", " ", 
   SuperscriptBox["q", 
    RowBox[{"571", "/", "120"}]]}], "+", 
  RowBox[{"76", " ", 
   SuperscriptBox["q", 
    RowBox[{"29", "/", "6"}]]}], "+", 
  RowBox[{"17", " ", 
   SuperscriptBox["q", 
    RowBox[{"293", "/", "60"}]]}], "+", 
  RowBox[{"177", " ", 
   SuperscriptBox["q", 
    RowBox[{"119", "/", "24"}]]}], "+", 
  RowBox[{"66", " ", 
   SuperscriptBox["q", 
    RowBox[{"1193", "/", "240"}]]}]}]], "Output",
 CellChangeTimes->{3.957280407217739*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"7a247605-7242-4634-99c3-9294c668c54e"]
}, Open  ]]
},
WindowSize->{713.25, 801},
WindowMargins->{{0, Automatic}, {Automatic, -810}},
Magnification:>1.1 Inherited,
FrontEndVersion->"14.2 for Linux x86 (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a56414f7-3c7b-4a71-956d-467a2591288a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 406, 9, 85, "Text",ExpressionUUID->"b3cb9778-9a98-4369-b810-b63afe3fb0e2"],
Cell[CellGroupData[{
Cell[985, 33, 16927, 400, 1649, "Input",ExpressionUUID->"b8f74f45-c15f-4d7c-a1c8-4941ffe4cb30"],
Cell[17915, 435, 1846, 26, 36, "Output",ExpressionUUID->"665d84fd-74ba-4bbe-8371-e4f7d3689c6c"]
}, Open  ]],
Cell[19776, 464, 907, 24, 61, "Text",ExpressionUUID->"374f45fe-8e7a-4c71-b67a-656f45063b90"],
Cell[20686, 490, 798, 25, 105, "DisplayFormula",ExpressionUUID->"b577fee4-116d-4870-b091-10112f2ae5a5"],
Cell[21487, 517, 4359, 74, 104, "Input",ExpressionUUID->"cc8849a8-0310-45a9-906f-41b7d76f2d17"],
Cell[25849, 593, 1379, 37, 109, "Text",ExpressionUUID->"a0e42558-53e7-425f-a96f-ebe905fa3a90"],
Cell[27231, 632, 896, 19, 59, "Input",ExpressionUUID->"99f87e43-4483-4a64-9013-cfb7c739bc83"],
Cell[28130, 653, 431, 9, 133, "Text",ExpressionUUID->"e8589dbc-d184-41eb-9981-748bb4303445"],
Cell[28564, 664, 3864, 101, 447, "Input",ExpressionUUID->"bdcf6f15-56e2-4b46-8bbd-f6586704e123"],
Cell[32431, 767, 466, 11, 109, "Text",ExpressionUUID->"081aedb1-6382-4ed5-b67e-9e7217a96752"],
Cell[32900, 780, 4359, 111, 617, "Input",ExpressionUUID->"44a5f4ed-63e0-41ba-92fc-28cd5913f879"],
Cell[CellGroupData[{
Cell[37284, 895, 229, 4, 73, "Input",ExpressionUUID->"7aa1467e-1277-4fc8-ad53-8202fcf8d7c9"],
Cell[37516, 901, 857, 24, 170, "Output",ExpressionUUID->"047a9800-b136-4ed9-8de2-20f3b647920a"]
}, Open  ]],
Cell[38388, 928, 169, 2, 32, "Input",ExpressionUUID->"b470888c-d7cb-4aee-9e55-92b125b5a46b"],
Cell[38560, 932, 568, 14, 85, "Text",ExpressionUUID->"3d9cada3-2cd3-4e5a-8d77-31973a113626"],
Cell[CellGroupData[{
Cell[39153, 950, 4880, 112, 426, "Input",ExpressionUUID->"6a764216-d3ea-4918-a22a-11788dd8b634"],
Cell[44036, 1064, 4967, 157, 273, "Output",ExpressionUUID->"eefbc07f-e86a-41a6-98f5-dd121b191a04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49040, 1226, 5301, 119, 426, "Input",ExpressionUUID->"064d08d2-c4af-4685-b9c2-1cdb6cd66691"],
Cell[54344, 1347, 3537, 118, 240, "Output",ExpressionUUID->"079d1135-b7ac-4b8e-8d6d-4dc538509fac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57918, 1470, 1251, 35, 174, "Input",ExpressionUUID->"11b65d1e-019b-46b8-b20e-929eaf8f7b66"],
Cell[59172, 1507, 6339, 216, 408, "Output",ExpressionUUID->"7a247605-7242-4634-99c3-9294c668c54e"]
}, Open  ]]
}
]
*)

