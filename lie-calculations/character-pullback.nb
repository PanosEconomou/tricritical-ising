(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     34933,        954]
NotebookOptionsPosition[     32735,        914]
NotebookOutlinePosition[     33131,        930]
CellTagsIndexPosition[     33088,        927]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Which characters should appear in the pullback?",
  FontWeight->"Bold"],
 "\nBefore we take the pullback it would be nice to reduce the characters \
that would appear in the Coset CFT character expansion in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["TIsing", "2"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "697b33cf-57e7-4c08-8dc2-c4fa96aa2d0c"],
 " characters."
}], "Text",
 CellChangeTimes->{{3.95374581604956*^9, 
  3.9537458735539913`*^9}},ExpressionUUID->"8faa4261-d8b2-435f-879a-\
2dfa765ef1ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "'"}], "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cv", "=", 
   RowBox[{"1", "-", 
    RowBox[{"6", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "-", 
         RowBox[{"p", "'"}]}], ")"}], "2"], 
      RowBox[{"p", " ", 
       RowBox[{"p", "'"}]}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hv", "[", 
    RowBox[{"r_", ",", "s_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", " ", "r"}], " ", "-", " ", 
        RowBox[{
         RowBox[{"p", "'"}], " ", "s"}]}], ")"}], "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"p", " ", "-", " ", 
        RowBox[{"p", "'"}]}], ")"}], "2"]}], 
    RowBox[{"4", " ", "p", " ", 
     RowBox[{"p", "'"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hvf", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"hv", "@@", "i"}], "+", 
    RowBox[{"hv", "@@", "j"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hf", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"H", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]inv", "[", 
    RowBox[{"q_", ",", 
     RowBox[{"N_", ":", "\[Infinity]"}]}], "]"}], ":=", 
   RowBox[{
    SubsuperscriptBox["\[Sum]", 
     RowBox[{"k", "=", "0"}], "N"], 
    RowBox[{
     RowBox[{"PartitionsP", "[", "k", "]"}], 
     SuperscriptBox["q", "k"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]v", "[", 
    RowBox[{"r_", ",", "s_", ",", "q_", ",", 
     RowBox[{"N_", ":", "\[Infinity]"}]}], "]"}], ":=", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Eta]inv", "[", "q", "]"}], 
      SuperscriptBox["q", 
       RowBox[{
        FractionBox["p", 
         RowBox[{"4", " ", 
          RowBox[{"p", "'"}]}]], "+", 
        FractionBox[
         RowBox[{"p", "'"}], 
         RowBox[{"4", " ", "p"}]], "-", 
        FractionBox["41", "80"]}]], 
      RowBox[{
       SubsuperscriptBox["\[Sum]", 
        RowBox[{"n", "=", 
         RowBox[{"-", "N"}]}], "N"], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q", 
          RowBox[{
           RowBox[{
            SuperscriptBox["n", "2"], " ", "p", " ", 
            RowBox[{"p", "'"}]}], "+", 
           RowBox[{"n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", " ", "r"}], "-", 
              RowBox[{"s", " ", 
               RowBox[{"p", "'"}]}]}], ")"}]}]}]], "-", 
         SuperscriptBox["q", 
          RowBox[{
           RowBox[{
            SuperscriptBox["n", "2"], " ", "p", " ", 
            RowBox[{"p", "'"}]}], "+", 
           RowBox[{"n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", " ", "r"}], "+", 
              RowBox[{"s", " ", 
               RowBox[{"p", "'"}]}]}], ")"}]}], "+", 
           RowBox[{"r", " ", "s"}]}]]}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", "0", ",", "N"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]vf", "[", 
    RowBox[{"i_", ",", "j_", ",", "q_", ",", "N_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Chi]v", "[", 
     RowBox[{
      RowBox[{"i", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"i", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "q", ",", "N"}], "]"}], 
    RowBox[{"\[Chi]v", "[", 
     RowBox[{
      RowBox[{"j", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"j", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "q", ",", "N"}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.953745901301113*^9, 3.953745954361245*^9}, {
   3.9537460259896717`*^9, 3.953746056036978*^9}, {3.953746087077651*^9, 
   3.9537460955092287`*^9}, {3.9537461836531553`*^9, 
   3.9537462366703663`*^9}, {3.953746361912455*^9, 3.953746363625537*^9}, {
   3.953746594376718*^9, 3.953746598455641*^9}, {3.953746644042429*^9, 
   3.95374666720785*^9}, {3.953746772614097*^9, 3.95374677504067*^9}, {
   3.953746838514142*^9, 3.953746846889565*^9}, {3.953746943978825*^9, 
   3.953746944476757*^9}, {3.95374709122817*^9, 3.9537471142286053`*^9}, {
   3.953747211237833*^9, 3.953747260763506*^9}, {3.953747379908654*^9, 
   3.9537473801392927`*^9}, {3.953747558344618*^9, 3.953747612100075*^9}, {
   3.953747667477975*^9, 3.9537476819086123`*^9}, {3.953747825223586*^9, 
   3.953747846662964*^9}, {3.953747900489862*^9, 3.953747979822732*^9}, {
   3.953748081288082*^9, 3.953748117880156*^9}, {3.953748173985189*^9, 
   3.953748181502832*^9}, {3.953748243664137*^9, 3.953748243749632*^9}, {
   3.9537482851204653`*^9, 3.953748297159688*^9}, {3.953748571347694*^9, 
   3.953748577802372*^9}, {3.953748679147197*^9, 3.9537486830703697`*^9}, {
   3.953748798681924*^9, 3.9537488113766403`*^9}, {3.95374926451614*^9, 
   3.953749266155107*^9}, {3.953749514148574*^9, 3.9537496326856737`*^9}, {
   3.9537499228308163`*^9, 3.953749934110021*^9}, {3.953751688753718*^9, 
   3.953751689988845*^9}, 3.9537526263215237`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"2f904d01-8623-4d6c-a15a-c409cd56a0b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cw", "=", 
   FractionBox[
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"k", "-", "1"}], ")"}]}], 
    RowBox[{"k", "+", "2"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hw", "[", 
    RowBox[{"l_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"l", 
      RowBox[{"(", 
       RowBox[{"l", "+", "2"}], ")"}]}], 
     RowBox[{"4", 
      RowBox[{"(", 
       RowBox[{"k", "+", "2"}], ")"}]}]], "-", 
    FractionBox[
     SuperscriptBox["m", "2"], 
     RowBox[{"4", "k"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]w", "[", 
    RowBox[{"l_", ",", "m_", ",", "q_", ",", 
     RowBox[{"N_", ":", "\[Infinity]"}]}], "]"}], ":=", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"\[Eta]inv", "[", "q", "]"}], "2"], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"r", "=", "0"}], "N"], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"s", "=", "0"}], "N"], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"r", "+", "s"}]], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["q", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r", "2"], "+", 
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "l", "-", "m", "+", "s"}], ")"}]}], "+", 
               RowBox[{"r", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "l", "+", "m", "+", 
                  RowBox[{"18", " ", "s"}]}], ")"}]}]}], ")"}]}]], "-", 
           SuperscriptBox["q", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"18", "+", 
               SuperscriptBox["r", "2"], "+", 
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{"19", "+", "m", "+", "s"}], ")"}]}], "-", 
               RowBox[{"l", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", "r", "+", "s"}], ")"}]}], "+", 
               RowBox[{"r", " ", 
                RowBox[{"(", 
                 RowBox[{"19", "-", "m", "+", 
                  RowBox[{"18", " ", "s"}]}], ")"}]}]}], ")"}]}]]}], 
          ")"}]}]}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", "0", ",", "N"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Chi]M", "[", 
     RowBox[{"A_", ",", "q_", ",", 
      RowBox[{"\[Chi]", ":", "\[Chi]vf"}], ",", 
      RowBox[{"N_", ":", "\[Infinity]"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"\[Chi]", "[", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "q", ",", "N"}], "]"}], 
     RowBox[{"\[Chi]", "[", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "q", ",", "N"}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "the", " ", "super", " ", "ugly", " ", "way", " ",
      "to", " ", "calculate", " ", "which", " ", "are", " ", "the", " ", 
     "possible", " ", "values", " ", "l"}], ",", 
    RowBox[{"m", " ", "without", " ", "degeneracies"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k", "+", "1"}], ",", 
       RowBox[{
        RowBox[{"2", "k"}], "+", "1"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M", "[", "m_", "]"}], ":=", 
   RowBox[{"m", "+", "k", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "[", "l_", "]"}], ":=", 
  RowBox[{"l", "+", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"l", "=", "0"}], ",", 
   RowBox[{"l", "<=", "k"}], ",", 
   RowBox[{"l", "++"}], ",", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"m", "=", 
      RowBox[{"-", "l"}]}], ",", 
     RowBox[{"m", "<=", "l"}], ",", 
     RowBox[{"m", "=", 
      RowBox[{"m", "+", "2"}]}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"L", "[", "l", "]"}], ",", 
           RowBox[{"M", "[", "m", "]"}]}], "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"L", "[", "l", "]"}], ",", 
            RowBox[{"M", "[", "m", "]"}]}], "]"}], "]"}], "=", "1"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"0", "<", 
           RowBox[{"M", "[", 
            RowBox[{"k", "-", "m"}], "]"}], "<=", 
           RowBox[{
            RowBox[{"2", "k"}], "+", "1"}]}], ",", 
          RowBox[{
           RowBox[{"w", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"L", "[", 
               RowBox[{"k", "-", "l"}], "]"}], ",", 
              RowBox[{"M", "[", 
               RowBox[{"k", "-", "m"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"-", "1"}]}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"0", "<", 
           RowBox[{"M", "[", 
            RowBox[{"k", "+", "m"}], "]"}], "<=", 
           RowBox[{
            RowBox[{"2", "k"}], "+", "1"}]}], ",", 
          RowBox[{
           RowBox[{"w", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"L", "[", 
               RowBox[{"k", "-", "l"}], "]"}], ",", 
              RowBox[{"M", "[", 
               RowBox[{"k", "+", "m"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"-", "1"}]}]}], "]"}], ";"}]}], "]"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", "k", "-", "1"}]}], "}"}], "&"}],
     "/@", 
    RowBox[{"Position", "[", 
     RowBox[{"w", ",", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", " ", "==", "1"}], "&"}], ")"}]}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.953748603042211*^9, 3.953748609647537*^9}, {
   3.953748658546946*^9, 3.953748675088818*^9}, {3.953748716464697*^9, 
   3.953748741561661*^9}, {3.953748785866673*^9, 3.953748795657866*^9}, {
   3.953748842363492*^9, 3.9537488565481033`*^9}, {3.953748899108232*^9, 
   3.953748899562522*^9}, 3.953748977374506*^9, {3.953749056255184*^9, 
   3.9537490889286823`*^9}, {3.9537491385232573`*^9, 3.95374915098085*^9}, {
   3.953749350396275*^9, 3.95374942012589*^9}, {3.953751806800543*^9, 
   3.9537518997926073`*^9}, {3.953751958129862*^9, 3.953751961880999*^9}, {
   3.953752699247809*^9, 3.953752699501873*^9}, {3.953803576988875*^9, 
   3.953803577315833*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"b8c56bcc-7646-4505-baa8-2000786ca732"],

Cell[TextData[{
 "\n",
 StyleBox["The conformal weights of the two models",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.953750035981659*^9, 
  3.9537500545087337`*^9}},ExpressionUUID->"092209c1-8ac2-4797-bb6a-\
94ade33a4427"],

Cell[TextData[Cell[BoxData[
 FormBox[
  SuperscriptBox["TIsing", "2"], TraditionalForm]],
 FormatType->
  TraditionalForm,ExpressionUUID->"61c9b40e-9ef3-4abd-8232-e0ad6cd5c398"]], \
"Text",
 CellChangeTimes->{{3.95375005612402*^9, 
  3.9537500759500637`*^9}},ExpressionUUID->"dd2abc22-6e50-4a52-909c-\
4dba95518ce8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sort", "[", 
  RowBox[{"hvf", " ", "@@@", "Hf"}], "]"}]], "Input",
 CellChangeTimes->{{3.953749658750966*^9, 3.953749794964164*^9}, {
  3.9537498977436037`*^9, 3.9537499162525797`*^9}, {3.953749954184742*^9, 
  3.953749959564508*^9}, {3.95380136899428*^9, 3.953801371081787*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"9b9badf3-b46a-4c84-a8c9-a1b6d209b2ef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox["3", "80"], ",", 
   FractionBox["3", "80"], ",", 
   FractionBox["3", "40"], ",", 
   FractionBox["1", "10"], ",", 
   FractionBox["1", "10"], ",", 
   FractionBox["11", "80"], ",", 
   FractionBox["11", "80"], ",", 
   FractionBox["1", "5"], ",", 
   FractionBox["7", "16"], ",", 
   FractionBox["7", "16"], ",", 
   FractionBox["19", "40"], ",", 
   FractionBox["19", "40"], ",", 
   FractionBox["43", "80"], ",", 
   FractionBox["43", "80"], ",", 
   FractionBox["3", "5"], ",", 
   FractionBox["3", "5"], ",", 
   FractionBox["51", "80"], ",", 
   FractionBox["51", "80"], ",", 
   FractionBox["7", "10"], ",", 
   FractionBox["7", "10"], ",", 
   FractionBox["7", "8"], ",", 
   FractionBox["83", "80"], ",", 
   FractionBox["83", "80"], ",", 
   FractionBox["6", "5"], ",", 
   FractionBox["3", "2"], ",", 
   FractionBox["3", "2"], ",", 
   FractionBox["123", "80"], ",", 
   FractionBox["123", "80"], ",", 
   FractionBox["8", "5"], ",", 
   FractionBox["8", "5"], ",", 
   FractionBox["31", "16"], ",", 
   FractionBox["31", "16"], ",", 
   FractionBox["21", "10"], ",", 
   FractionBox["21", "10"], ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.9537496652355013`*^9, 3.953749686031291*^9}, 
   3.953749719772896*^9, 3.9537497547907248`*^9, {3.953749786819028*^9, 
   3.95374979519948*^9}, {3.95374989915733*^9, 3.953749916533123*^9}, 
   3.953749959835203*^9, 3.9537526375223293`*^9, 3.95380137140972*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"6e538ef2-5079-474f-ada2-d816e41066b1"]
}, Open  ]],

Cell["Coset", "Text",
 CellChangeTimes->{{3.9537500793623734`*^9, 
  3.953750087908688*^9}},ExpressionUUID->"e48e6570-89c2-4455-89fd-\
09d129ef137e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sort", "[", 
  RowBox[{"hw", " ", "@@@", "W"}], "]"}]], "Input",
 CellChangeTimes->{{3.953749970844489*^9, 3.953749973828486*^9}, {
  3.953801361042254*^9, 3.953801363281733*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"2ea014bc-fda0-4c56-9559-c2c4d42ab1ae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox["7", "160"], ",", 
   FractionBox["7", "160"], ",", 
   FractionBox["3", "40"], ",", 
   FractionBox["3", "40"], ",", 
   FractionBox["3", "32"], ",", 
   FractionBox["3", "32"], ",", 
   FractionBox["1", "10"], ",", 
   FractionBox["1", "5"], ",", 
   FractionBox["11", "32"], ",", 
   FractionBox["11", "32"], ",", 
   FractionBox["19", "40"], ",", 
   FractionBox["19", "40"], ",", 
   FractionBox["19", "32"], ",", 
   FractionBox["19", "32"], ",", 
   FractionBox["3", "5"], ",", 
   FractionBox["7", "10"], ",", 
   FractionBox["7", "10"], ",", 
   FractionBox["127", "160"], ",", 
   FractionBox["127", "160"], ",", 
   FractionBox["27", "32"], ",", 
   FractionBox["27", "32"], ",", 
   FractionBox["7", "8"], ",", 
   FractionBox["7", "8"], ",", 
   FractionBox["43", "40"], ",", 
   FractionBox["43", "40"], ",", 
   FractionBox["6", "5"], ",", 
   FractionBox["207", "160"], ",", 
   FractionBox["207", "160"], ",", 
   FractionBox["3", "2"], ",", 
   FractionBox["3", "2"], ",", 
   FractionBox["247", "160"], ",", 
   FractionBox["247", "160"], ",", 
   FractionBox["15", "8"], ",", 
   FractionBox["15", "8"], ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.953749974205408*^9, 3.953752637545972*^9, 
  3.953801363630221*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"7a847aee-4472-4683-91ef-ee9a4de67040"]
}, Open  ]],

Cell[TextData[StyleBox["Now let\[CloseCurlyQuote]s find the compatible \
combinations of characters",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.9537500954127617`*^9, 
  3.9537501098050528`*^9}},ExpressionUUID->"e0d384a0-9744-40f8-b04d-\
0edc867b0fbd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Wpairs", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"W", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hfpairs", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"Hf", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"weightsM", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hw", "@@", "#1"}], "+", 
         RowBox[{"hw", "@@", "#2"}]}], ")"}], "&"}], "@@@", "Wpairs"}], "]"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allowedModules", "=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"h", ",", 
      RowBox[{"{", 
       RowBox[{"h", ",", 
        RowBox[{"Hfpairs", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"Hfpairs", ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"hvf", "@@", "#1"}], "+", 
                    RowBox[{"hvf", "@@", "#2"}]}], ")"}], "&"}], "@@", "#"}], 
                   " ", "-", " ", "h"}], ")"}], "\[Element]", 
                 TemplateBox[{},
                  "Integers"]}], "&"}], ")"}]}], ",", "1"}], "]"}], "//", 
           "Flatten"}], "]"}], "]"}]}], "}"}]}], "]"}], "/@", "weightsM"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"weightsToModules", "=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"h", ",", 
      RowBox[{"{", 
       RowBox[{"h", ",", 
        RowBox[{"Wpairs", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"Wpairs", ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"hw", "@@", "#1"}], "+", 
                    RowBox[{"hw", "@@", "#2"}]}], ")"}], "&"}], "@@", "#"}], 
                 " ", "==", " ", "h"}], "&"}], ")"}]}], ",", "1"}], "]"}], "//",
            "Flatten"}], "]"}], "]"}]}], "}"}]}], "]"}], "/@", "weightsM"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.953750163117528*^9, 3.9537502609180183`*^9}, {
  3.9537503301046333`*^9, 3.9537503490639677`*^9}, {3.953750383575697*^9, 
  3.95375039100004*^9}, {3.9537504394799623`*^9, 3.953750459911531*^9}, {
  3.953750502464576*^9, 3.953750625500774*^9}, {3.9537506675402727`*^9, 
  3.953750697164707*^9}, {3.953750776327098*^9, 3.953750811324849*^9}, {
  3.953750862695705*^9, 3.953750939508477*^9}, {3.953751178737789*^9, 
  3.9537511806406603`*^9}, {3.953751273138138*^9, 3.95375129208762*^9}, {
  3.953751421939149*^9, 3.953751477259018*^9}, {3.9537515413644657`*^9, 
  3.953751555577355*^9}, {3.953803470874968*^9, 3.953803485867888*^9}, {
  3.953807567236339*^9, 3.953807571531013*^9}},
 CellLabel->
  "In[362]:=",ExpressionUUID->"0b488359-5731-4604-b59f-2cf803ad4ace"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"allowedModules", "[", 
    RowBox[{"[", 
     RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cpf", "=", 
   RowBox[{
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Chi]M", "[", 
        RowBox[{"#", ",", "q", ",", "\[Chi]w", ",", "n"}], "]"}], "&"}], "/@", 
      RowBox[{"weightsToModules", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pfs", "=", " ", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["q", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"hvf", "@@", "#1"}], "+", 
             RowBox[{"hvf", "@@", "#2"}]}], ")"}], "&"}], "@@", "#"}], "-", 
         "h"}]], 
       RowBox[{"\[Chi]M", "[", 
        RowBox[{"#", ",", "q", ",", "\[Chi]vf", ",", "n"}], "]"}]}], "&"}], "/@", 
     RowBox[{"allowedModules", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Coefficients", "[", 
    RowBox[{"targetPf_", ",", "pfs_"}], "]"}], ":=", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CoefficientList", "[", 
         RowBox[{"#", ",", "q", ",", "n"}], "]"}], "&"}], "@", "pfs"}], "]"}],
      ",", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"targetPf", ",", "q", ",", "n"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"x", "=", 
  RowBox[{"Coefficients", "[", 
   RowBox[{"cpf", ",", "pfs"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"x", "*", "pfs"}], "]"}], "-", "cpf"}]}], "Input",
 CellChangeTimes->{{3.953751619064286*^9, 3.953751684205097*^9}, {
   3.953752493917625*^9, 3.9537525145789433`*^9}, {3.953752588707762*^9, 
   3.953752590377561*^9}, {3.953752674340975*^9, 3.953752705706154*^9}, 
   3.95380354064087*^9, 3.9538036338335867`*^9, {3.953804178540464*^9, 
   3.95380418713172*^9}, {3.953804433589198*^9, 3.9538044560927753`*^9}, 
   3.95380569390996*^9, {3.953805963471141*^9, 3.953805964332159*^9}, {
   3.953806536942995*^9, 3.953806538588635*^9}, {3.953806580591723*^9, 
   3.953806581019856*^9}, {3.9538067489686613`*^9, 3.9538067490603228`*^9}, {
   3.9538068412950487`*^9, 3.953807055183037*^9}, {3.953807130336204*^9, 
   3.953807131679078*^9}, {3.9538071686486683`*^9, 3.953807215078527*^9}, {
   3.9538074947693157`*^9, 3.953807506569981*^9}, {3.953809376671577*^9, 
   3.953809410542647*^9}},
 CellLabel->
  "In[808]:=",ExpressionUUID->"fa222ea3-1653-44ca-bda5-38e0ac4da1cb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "1"}], ",", "0", ",", 
   RowBox[{"-", "4"}], ",", "4", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.953807181163465*^9, 3.953807204290604*^9}, 
   3.9538072401962833`*^9, 3.953807275419882*^9, {3.953807495403001*^9, 
   3.953807506892318*^9}, {3.95380938391671*^9, 3.95380941074091*^9}},
 CellLabel->
  "Out[814]=",ExpressionUUID->"74ba7132-fa30-4445-be2a-a4be77d7fcc6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"3", " ", 
    SuperscriptBox["q", "6"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "q", "]"}], "7"],
    SeriesData[$CellContext`q, 0, {}, 6, 7, 1],
    Editable->False]}],
  SeriesData[$CellContext`q, 0, {3}, 6, 7, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.953807181163465*^9, 3.953807204290604*^9}, 
   3.9538072401962833`*^9, 3.953807275419882*^9, {3.953807495403001*^9, 
   3.953807506892318*^9}, {3.95380938391671*^9, 3.9538094107418623`*^9}},
 CellLabel->
  "Out[815]=",ExpressionUUID->"114a286f-46ad-4f06-a07b-b023290e8515"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"weightsC", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"hw", "@@@", "W"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allowedCharacters", "=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"h", ",", 
      RowBox[{"{", 
       RowBox[{"h", ",", 
        RowBox[{"Hf", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"Hf", ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"hvf", "@@", "#"}], " ", "-", " ", "h"}], ")"}], "\[Element]", 
                 TemplateBox[{},
                  "Integers"]}], "&"}], ")"}]}], ",", "1"}], "]"}], "//", 
           "Flatten"}], "]"}], "]"}]}], "}"}]}], "]"}], "/@", "weightsC"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"weightsToCharacters", "=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"h", ",", 
      RowBox[{"{", 
       RowBox[{"h", ",", 
        RowBox[{"W", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"W", ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"hw", "@@", "#"}], " ", "==", " ", "h"}], "&"}], 
               ")"}]}], ",", "1"}], "]"}], "//", "Flatten"}], "]"}], "]"}]}], 
       "}"}]}], "]"}], "/@", "weightsC"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.953750163117528*^9, 3.9537502609180183`*^9}, {
  3.9537503301046333`*^9, 3.9537503490639677`*^9}, {3.953750383575697*^9, 
  3.95375039100004*^9}, {3.9537504394799623`*^9, 3.953750459911531*^9}, {
  3.953750502464576*^9, 3.953750625500774*^9}, {3.9537506675402727`*^9, 
  3.953750697164707*^9}, {3.953750776327098*^9, 3.953750811324849*^9}, {
  3.953750862695705*^9, 3.953750939508477*^9}, {3.953751178737789*^9, 
  3.9537511806406603`*^9}, {3.953751273138138*^9, 3.95375129208762*^9}, {
  3.953751421939149*^9, 3.953751477259018*^9}, {3.9537515413644657`*^9, 
  3.953751555577355*^9}, {3.953803470874968*^9, 3.953803485867888*^9}, {
  3.9538036917394867`*^9, 3.9538037738604803`*^9}, {3.9538040363993483`*^9, 
  3.953804101604374*^9}, {3.953807544748148*^9, 3.953807559179879*^9}},
 CellLabel->
  "In[816]:=",ExpressionUUID->"9673584f-74bf-4d84-8665-68895aeb8dc4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"allowedCharacters", "[", 
    RowBox[{"[", 
     RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cpf", "=", 
   RowBox[{
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Chi]w", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "q", ",", "n"}], "]"}], "&"}], 
      "/@", 
      RowBox[{"weightsToCharacters", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pfs", "=", " ", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["q", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"hvf", "@@", "#"}], ")"}], "&"}], "@", "#"}], "-", "h"}]], 
       RowBox[{"\[Chi]vf", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "q", ",", "n"}], "]"}]}], 
      "&"}], "/@", 
     RowBox[{"allowedCharacters", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"x", "=", 
  RowBox[{"LinearSolve", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"CoefficientList", "[", 
        RowBox[{"#", ",", "q", ",", "n"}], "]"}], "&"}], "@", "pfs"}], "]"}], 
    ",", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{"cpf", ",", "q", ",", "n"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"x", "*", "pfs"}], "]"}], "-", 
  "cpf"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.953807663541616*^9, 3.953807680474763*^9}, {
   3.9538083811194153`*^9, 3.9538083908648453`*^9}, {3.953808562464095*^9, 
   3.9538086112248983`*^9}, {3.953808809123197*^9, 3.953808818487937*^9}, {
   3.953808973115313*^9, 3.953808982961763*^9}, {3.95380904411411*^9, 
   3.953809112625692*^9}, {3.9538091440433197`*^9, 3.953809188505129*^9}, {
   3.953809220067751*^9, 3.953809284192772*^9}, 3.953809315046955*^9},
 CellLabel->
  "In[819]:=",ExpressionUUID->"f6d8414d-6508-42d4-b472-5b8ec0f5e696"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.9538086115923*^9, {3.9538088097669067`*^9, 3.953808818849744*^9}, {
   3.95380897350557*^9, 3.9538089834464283`*^9}, {3.953809057965859*^9, 
   3.9538091129948997`*^9}, {3.953809156574675*^9, 3.953809188953371*^9}, {
   3.953809220560611*^9, 3.9538093153180037`*^9}, 3.953809430287037*^9},
 CellLabel->
  "Out[824]=",ExpressionUUID->"c996a83c-9adf-4f1f-9684-0ebe2324c608"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "q", "]"}], "11"],
  SeriesData[$CellContext`q, 0, {}, 11, 11, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.9538086115923*^9, {3.9538088097669067`*^9, 3.953808818849744*^9}, {
   3.95380897350557*^9, 3.9538089834464283`*^9}, {3.953809057965859*^9, 
   3.9538091129948997`*^9}, {3.953809156574675*^9, 3.953809188953371*^9}, {
   3.953809220560611*^9, 3.9538093153180037`*^9}, 3.953809430287939*^9},
 CellLabel->
  "Out[825]=",ExpressionUUID->"6ab85089-f9d3-491c-ba6e-5fe4af8a2323"]
}, Open  ]]
},
WindowSize->{1431, 801},
WindowMargins->{{0, Automatic}, {Automatic, -810}},
FrontEndVersion->"14.2 for Linux x86 (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e9544a8a-366d-4c38-b616-ac5408129bae"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 560, 14, 55, "Text",ExpressionUUID->"8faa4261-d8b2-435f-879a-2dfa765ef1ec"],
Cell[1117, 36, 5848, 162, 460, "Input",ExpressionUUID->"2f904d01-8623-4d6c-a15a-c409cd56a0b2"],
Cell[6968, 200, 7580, 217, 464, "Input",ExpressionUUID->"b8c56bcc-7646-4505-baa8-2000786ca732"],
Cell[14551, 419, 237, 7, 55, "Text",ExpressionUUID->"092209c1-8ac2-4797-bb6a-94ade33a4427"],
Cell[14791, 428, 316, 8, 33, "Text",ExpressionUUID->"dd2abc22-6e50-4a52-909c-4dba95518ce8"],
Cell[CellGroupData[{
Cell[15132, 440, 382, 6, 30, "Input",ExpressionUUID->"9b9badf3-b46a-4c84-a8c9-a1b6d209b2ef"],
Cell[15517, 448, 1566, 41, 60, "Output",ExpressionUUID->"6e538ef2-5079-474f-ada2-d816e41066b1"]
}, Open  ]],
Cell[17098, 492, 149, 3, 33, "Text",ExpressionUUID->"e48e6570-89c2-4455-89fd-09d129ef137e"],
Cell[CellGroupData[{
Cell[17272, 499, 282, 5, 30, "Input",ExpressionUUID->"2ea014bc-fda0-4c56-9559-c2c4d42ab1ae"],
Cell[17557, 506, 1386, 39, 60, "Output",ExpressionUUID->"7a847aee-4472-4683-91ef-ee9a4de67040"]
}, Open  ]],
Cell[18958, 548, 262, 5, 33, "Text",ExpressionUUID->"e0d384a0-9744-40f8-b04d-0edc867b0fbd"],
Cell[19223, 555, 3252, 85, 120, "Input",ExpressionUUID->"0b488359-5731-4604-b59f-2cf803ad4ace"],
Cell[CellGroupData[{
Cell[22500, 644, 2988, 75, 270, "Input",ExpressionUUID->"fa222ea3-1653-44ca-bda5-38e0ac4da1cb"],
Cell[25491, 721, 444, 9, 34, "Output",ExpressionUUID->"74ba7132-fa30-4445-be2a-a4be77d7fcc6"],
Cell[25938, 732, 633, 16, 41, "Output",ExpressionUUID->"114a286f-46ad-4f06-a07b-b023290e8515"]
}, Open  ]],
Cell[26586, 751, 2482, 60, 75, "Input",ExpressionUUID->"9673584f-74bf-4d84-8665-68895aeb8dc4"],
Cell[CellGroupData[{
Cell[29093, 815, 2583, 71, 268, "Input",ExpressionUUID->"f6d8414d-6508-42d4-b472-5b8ec0f5e696"],
Cell[31679, 888, 470, 9, 34, "Output",ExpressionUUID->"c996a83c-9adf-4f1f-9684-0ebe2324c608"],
Cell[32152, 899, 567, 12, 41, "Output",ExpressionUUID->"6ab85089-f9d3-491c-ba6e-5fe4af8a2323"]
}, Open  ]]
}
]
*)

